<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Post-hoc-Tests</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="images/broom.ico">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Chamber of Statistics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Allgemeines
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="software.html">Software</a>
    </li>
    <li>
      <a href="r-basics.html">R Basics</a>
    </li>
    <li>
      <a href="stil.html">Stil</a>
    </li>
    <li>
      <a href="pakete.html">Pakete</a>
    </li>
    <li>
      <a href="data-wrangling.html">Data Wrangling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Mittelwerte vergleichen
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mittelwerte-vergleichen.html">Überblick</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">t-Tests</li>
    <li>
      <a href="t-test-einstichprobe.html">Bei einer Stichprobe</a>
    </li>
    <li>
      <a href="t-test-unabhaengig.html">Bei unabhängigen Stichproben</a>
    </li>
    <li>
      <a href="t-test-abhaengig.html">Bei abhängigen Stichproben</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">ANOVAs</li>
    <li>
      <a href="einfaktorielle-anova.html">Einfaktorielle ANOVA</a>
    </li>
    <li>
      <a href="faktorielle-anova.html">Faktorielle ANOVA</a>
    </li>
    <li class="dropdown-header">ANCOVA</li>
    <li class="dropdown-header">Repeated Measures ANOVA</li>
    <li class="dropdown-header">Mixed ANOVA</li>
    <li>
      <a href="kontraste.html">Geplante Kontraste</a>
    </li>
    <li>
      <a href="post-hoc-tests.html">Post-hoc-Tests</a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li>
  <a href="effektstaerken.html">Effektstärken</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="voraussetzungen.html">Voraussetzungen im GLM</a>
    </li>
    <li>
      <a href="zentraler-grenzwertsatz.html">Zentraler Grenzwertsatz</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Post-hoc-Tests</h1>

</div>


<p><img src="images/sprint_r.jpg" /></p>
<p>Eine ANOVA ist ein <strong>Omnibus-Test</strong>, d.h., dass uns ein signifikanter <span class="math inline">\(F\)</span>-Wert erstmal nur sagt, dass sich die Gruppenmittelwerte (die Mittelwerte der unterschiedlichen Faktorstufen) voneinander unterscheiden. Wir wissen aber noch nicht <em>wo</em>. Im Grunde ist ein signifikantes Ergebnis einer ANOVA eine Aufforderung dazu, weitere Untersuchungen anzustellen. An dieser Stelle hat man nun zwei Möglichkeiten; entweder man hat bereits eine Hypohese oder Ahnung, wo die Unterschiede liegen könnten. In diesem Fall kann man vorab <strong>Kontrase</strong> (also geplante Kontraste) definieren und diese Unterschiede prüfen. Hat man keine Hypothesen und will “sich überraschen lassen”, macht man einen <strong>Post-hoc-Test</strong>. Wir jagen unseren potenziellen Unterschieden also hinterher.</p>
<div id="grundidee" class="section level1">
<h1>Grundidee</h1>
<p>Im Gegensatz zu den auf unseren Hypothesen fundierenden <a href="kontraste.html">geplanten Kontrasten</a> sind Post-hoc-Tests relativ brutal und einfallslos. Sie nehmen sich alle Gruppen der von uns definierten Faktoren vor und berechnen paarweise Vergleiche; also werden im Prinzip ganz viele <span class="math inline">\(t\)</span>-Tests berechnet. Das hört sich nach einer ganz dummen Idee an und ist es ohne spezielle Vorkehrungen auch, denn durch die vielen Tests auf einmal, kommt es zur <span class="math inline">\(\alpha\)</span>-Fehler-Kumulierung. Was ist denn das jetzt schon wieder?</p>
<p>Irgendwann wurde willkürlich festgelegt, dass ein <span class="math inline">\(p &lt; 0.05\)</span> ein statistisch signifikantes Ergebnis bedeutet. Mit diesem Signifikanzniveau von <span class="math inline">\(\alpha = 0.05\)</span> gehen wir vorab also immer davon aus, dass die Wahrscheinlichkeit einen Fehler 1. Art (<span class="math inline">\(\alpha\)</span>-Fehler) zu begehen 5% ist. Ein Fehler 1. Art tritt ein, wenn wir uns dafür entscheiden, einen Effekt gefunden zu haben, obwohl es eigentlich keinen gibt. Gibt es also wirklich <em>keinen</em> Effekt in einer Population, und führen wir unser Experiment 100 Mal immer auf dieselbe Art und Weise durch, gehen wir davon aus, dass wir fälschlicherweise trotzdem 5 Mal ein signifikantes Ergenis erhalten. Macht man jetzt mehrere Tests, wie es bei den Post-hoc-Tests nun gemacht werden soll, erhöht sich auch die Wahrscheinlichkeit einen Fehler 1. Art zu begehen. Diese Wahrscheinlichkeit eines Fehlers 1. Art lässt sich berechnen durch <span class="math display">\[\text{Fehler} = 1 - (0.95)^n\]</span></p>
<p>Führen wir einen Test durch, ist die Wahrscheinlichkeit eines <span class="math inline">\(\alpha\)</span>-Fehlers <span class="math inline">\(1 - (0.95)^1 = 0.05\)</span>, also 5%, wie ursprünglich definert. Mit der Anzahl unserer Tests steigt die Wahrscheinlichkeit eines Fehlers jedoch rapide. Bei drei Tests sind es schon <span class="math inline">\(1-(0.95)^3 = 14.3\,\%\)</span> und bei 5 Tests <span class="math inline">\(1-(0.95)^5 = 22.6\,\%\)</span>. Bei fünf paarweisen Vergleichen gehen wir also schon vorab davon aus, dass mindestens einer fälschlicherweise signifikant ist. Na super. Und jetzt?</p>
</div>
<div id="implementierung" class="section level1">
<h1>Implementierung</h1>
<p>Es gab und gibt viele kluge Köpfe, die sich dem Problem angenommen haben. Ihre Idee war nun, das Signifikanzniveau von <span class="math inline">\(\alpha = 0.05\)</span> zu reduzieren, um so die Schwelle, ab wann ein Ergebnis statistisch signifikant ist, niedriger zu legen. Clever! Es gibt mittlerweile viele Möglichkeiten, den <span class="math inline">\(p\)</span>-Wert bei Post-hoc-Tests zu korrigieren, deshalb haben <span class="citation">Toothaker (<a href="#ref-Toothaker.1993" role="doc-biblioref">1993</a>)</span> und <span class="citation">Field (<a href="#ref-Field.2018" role="doc-biblioref">2018</a>)</span> diese für uns im Bereich der ANOVA-Designs zusammengefasst:</p>
<table>
<thead>
<tr class="header">
<th>Gruppengröße</th>
<th>Populations-Varianzen</th>
<th>Verfahren</th>
<th>Referenz</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Gleichgroß</td>
<td>Homogen</td>
<td>Tukey HSD</td>
<td><span class="citation">Tukey (<a href="#ref-Tukey.1949" role="doc-biblioref">1949</a>)</span></td>
</tr>
<tr class="even">
<td>Leicht unterschiedlich</td>
<td>Homogen</td>
<td>Gabriel</td>
<td><span class="citation">Gabriel (<a href="#ref-Gabriel.1969" role="doc-biblioref">1969</a>)</span></td>
</tr>
<tr class="odd">
<td>Sehr unterschiedlich</td>
<td>Homogen</td>
<td>Hochbergs GT2</td>
<td><span class="citation">Hochberg (<a href="#ref-Hochberg.1974" role="doc-biblioref">1974</a>)</span>, <span class="citation">Hochberg (<a href="#ref-Hochberg.1975" role="doc-biblioref">1975</a>)</span></td>
</tr>
<tr class="even">
<td>Egal</td>
<td>Unterschiedlich</td>
<td>Games-Howell</td>
<td><span class="citation">Games &amp; Howell (<a href="#ref-Games.1976" role="doc-biblioref">1976</a>)</span></td>
</tr>
</tbody>
</table>
<p>Die Methode, die alle kennen (Bonferroni) wird nicht mehr empfohlen, weil sie zu konservativ ist. Möchte man jedoch eine ähnliche Methode durchführen, sollte man die (Bonferroni-)Holm-Methode <span class="citation">(Holm, <a href="#ref-Holm.1979" role="doc-biblioref">1979</a>)</span> in Betracht ziehen, da diese mehr Power hat.</p>
<p>Tukey HSD und Bonferroni-Holm können mit Funktionen aus dem Paket <code>rstatix</code> durchgeführt werden. Für letztere muss jedoch das Paket <code>emmeans</code> <span class="citation">(Lenth, <a href="#ref-Lenth.2020" role="doc-biblioref">2020</a>)</span> installiert sein.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Tukey HSD</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">&lt;</span>DATA<span class="op">&gt;</span><span class="st"> </span><span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tukey_hsd</span>(<span class="op">&lt;</span>DV<span class="op">&gt;</span><span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="er">&lt;</span>PRED<span class="op">&gt;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Bonferroni-Holm</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="op">&lt;</span>DATA<span class="op">&gt;</span><span class="st"> </span><span class="op">%&gt;%</span><span class="st"> </span><span class="kw">emmeans_test</span>(<span class="op">&lt;</span>DV<span class="op">&gt;</span><span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="er">&lt;</span>PRED<span class="op">&gt;</span>, <span class="dt">p.adjust.method =</span> <span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<p>Für die anderen Tests sieht es in R schlecht aus. Dafür bietet R viele weitere Tests, die stattdessen eingesetzt werden können. Weitere Informationen dazu findet man bei <span class="citation">Field (<a href="#ref-Field.2018" role="doc-biblioref">2018</a>)</span>.</p>
</div>
<div id="beispiel" class="section level1">
<h1>Beispiel</h1>
<p>Für das Beispiel der <a href="einfaktorielle-anova.html">einfaktoriellen ANOVA</a> hatten wir uns einen fiktiven Datensatz zu Besuchern des Phantasialandes angeschaut. In diesem Datensatz finden wir die empfundene Freude von 186 Besuchern des Phantasialandes (Variable <code>joy</code>), eingeteilt in Gruppen von Handgepäck-Typ. Wir haben Besucher ohne Handgepäck, mit leichtem und schwerem Rucksack und jenen, die einen Bollerwagen ziehen müssen. Mit der einfaktoriellen ANOVA haben wir bereits herausgefunden, dass sich diese Gruppen hinsichtlich ihrer Freude signifikant unterscheiden.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>phantasialand &lt;-<span class="st"> </span><span class="kw">read_spss</span>(<span class="st">&quot;data/phantasialand.sav&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  </span><span class="kw">mutate_if</span>(is.labelled, as_factor)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Datensatz</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>phantasialand</span></code></pre></div>
<pre><code>## # A tibble: 186 x 3
##    id    backpack   joy
##    &lt;chr&gt; &lt;fct&gt;    &lt;dbl&gt;
##  1 1     Light        5
##  2 2     Light        7
##  3 3     Handcart     3
##  4 4     Heavy        6
##  5 5     Heavy        3
##  6 6     Heavy        6
##  7 7     Handcart     4
##  8 8     None        10
##  9 9     None         9
## 10 10    Handcart     5
## # ... with 176 more rows</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Boxplot</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>phantasialand <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> backpack, <span class="dt">y =</span> joy)) <span class="op">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">outlier.color =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Gepäck&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Freude&quot;</span>)</span></code></pre></div>
<p><img src="post-hoc-tests_files/figure-html/unnamed-chunk-3-1.png" width="2450" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># ANOVA</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>phantasialand <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="st">  </span><span class="kw">anova_test</span>(joy <span class="op">~</span><span class="st"> </span>backpack)</span></code></pre></div>
<pre><code>## ANOVA Table (type II tests)
## 
##     Effect DFn DFd       F        p p&lt;.05   ges
## 1 backpack   3 182 126.164 3.14e-44     * 0.675</code></pre>
<p>An dieser Stelle könnten wir entweder den Tukey HSD durchführen oder paarweise Vergleiche mit Bonferroni-Holm-Korrektur durchführen.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Tukey HSD</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>phantasialand <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="st">  </span><span class="kw">tukey_hsd</span>(joy <span class="op">~</span><span class="st"> </span>backpack)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   term     group1 group2   estimate conf.low conf.high    p.adj p.adj.signif
## * &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
## 1 backpack None   Light      -2.01     -2.80    -1.23  2.20e- 9 ****        
## 2 backpack None   Heavy      -2.61     -3.39    -1.83  6.93e-14 ****        
## 3 backpack None   Handcart   -6.44     -7.32    -5.57  1.73e-14 ****        
## 4 backpack Light  Heavy      -0.592    -1.32     0.139 1.57e- 1 ns          
## 5 backpack Light  Handcart   -4.43     -5.26    -3.60  1.73e-14 ****        
## 6 backpack Heavy  Handcart   -3.84     -4.66    -3.01  2.01e-14 ****</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Bonferroni-Holm</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>phantasialand <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">emmeans_test</span>(joy <span class="op">~</span><span class="st"> </span>backpack, <span class="dt">p.adjust.method =</span> <span class="st">&quot;holm&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   .y.   group1 group2      df statistic        p    p.adj p.adj.signif
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
## 1 joy   None   Light      182      6.63 3.67e-10 7.35e-10 ****        
## 2 joy   None   Heavy      182      8.68 2.15e-15 6.44e-15 ****        
## 3 joy   None   Handcart   182     19.1  1.87e-45 1.12e-44 ****        
## 4 joy   Light  Heavy      182      2.10 3.70e- 2 3.70e- 2 *           
## 5 joy   Light  Handcart   182     13.8  3.54e-30 1.77e-29 ****        
## 6 joy   Heavy  Handcart   182     12.1  4.05e-25 1.62e-24 ****</code></pre>
<p>In diesem Fall liefern die beiden Verfahren unterschiedliche Ergebnisse. Nach der Tukey-Methode finden wir signifikante Unterschiede zwischen allen Gruppen, jedoch keinen signifikanten Unterschied zwischen jenen Besuchern mit leichten und schweren Rucksäcken. Nach der Bonferroni-Holm-Methode hingegen finden ir einen signifikanten Unterschied, da <span class="math inline">\(p = .037\)</span>. Das ist zwar “nur knapp” unter unserem Signifikanzniveau von <span class="math inline">\(\alpha = 0.05\)</span>, aber bei der Signifikanz ist das wie bei einer Schwangerschaft: Man ist entweder schwanger oder nicht. Es gibt kein “bisschen” schwanger oder “gerade so schwanger”. Es gibt auch kein “schwangerer” oder “gerade nicht schwanger”/“marginal schwanger”; man sollte bei solchen Formulierungen in Bezug auf statistische Signifikanz berechtigterweise kritisch sein. In den meisten Fällen hat der Autor einfach selbst keine Ahnung.</p>
<p>Die unterschiedlichen Ergebnisse von zwei unterschiedlichen Test bei identischer Datenlage ist jedenfalls nicht ungewöhnlich. Auf der sicheren Seite ist man, wenn man sich <em>vor</em> der Analyse auf Basis der Literatur für ein Verfahren entscheidet und dann <em>nur</em> dieses Verfahren durchführt.</p>
</div>
<div id="robuste-methoden" class="section level1">
<h1>Robuste Methoden</h1>
<p>Auch für Post-hoc-Tests hat Rand <span class="citation">Wilcox (<a href="#ref-Wilcox.2012" role="doc-biblioref">2012</a>)</span> natürlich robuste Alternativen entwickelt und im Paket <code>WRS2</code> <span class="citation">(Mair &amp; Wilcox, <a href="#ref-Mair.2020" role="doc-biblioref">2020</a>)</span> umgesetzt. Für einfaktorielle Varianzanalysen ist das die Funktion <code>lincon()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">lincon</span>(<span class="op">&lt;</span>DV<span class="op">&gt;</span><span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="er">&lt;</span>PRED<span class="op">&gt;</span>, <span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>)</span></code></pre></div>
<div id="beispiel-1" class="section level2">
<h2>Beispiel</h2>
<p>Bei unserem Beispiel aus dem Phantasialand sähe das folgendermaßen aus.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">lincon</span>(joy <span class="op">~</span><span class="st"> </span>backpack, <span class="dt">data =</span> phantasialand)</span></code></pre></div>
<pre><code>## Call:
## lincon(formula = joy ~ backpack, data = phantasialand)
## 
##                     psihat ci.lower ci.upper p.value
## None vs. Light     2.36830  1.55112  3.18548 0.00000
## None vs. Heavy     2.77828  1.87293  3.68364 0.00000
## None vs. Handcart  6.64103  5.53054  7.75151 0.00000
## Light vs. Heavy    0.40998 -0.44968  1.26964 0.20021
## Light vs. Handcart 4.27273  3.19526  5.35019 0.00000
## Heavy vs. Handcart 3.86275  2.72189  5.00360 0.00000</code></pre>
<p>Hier sind die Ergebnisse in Einklang mit der Tukey-HSD-Methode, es gibt keinenen statitistisch signifikanten Unterschied zwischen jenen Besuchern mit leichten und schweren Rucksäcken.</p>
</div>
</div>
<div id="literatur" class="section level1 unnumbered">
<h1>Literatur</h1>
<div id="refs" class="references">
<div id="ref-Field.2018">
<p>Field, A. P. (2018). <em>Discovering Statistics using IBM SPSS Statistics</em> (5th ed.). SAGE.</p>
</div>
<div id="ref-Gabriel.1969">
<p>Gabriel, K. R. (1969). Simultaneous Test Procedures - Some Theory of Multiple Comparisons. <em>The Annals of Mathematical Statistics</em>, <em>40</em>(1), 224–250.</p>
</div>
<div id="ref-Games.1976">
<p>Games, P. A., &amp; Howell, J. F. (1976). Pairwise Multiple Comparison Procedures with Unequal N’s and/or Variances: A Monte Carlo Study. <em>Journal of Educational Statistics</em>, <em>1</em>(2), 113–125. <a href="https://doi.org/10.3102/10769986001002113">https://doi.org/10.3102/10769986001002113</a></p>
</div>
<div id="ref-Hochberg.1974">
<p>Hochberg, Y. (1974). <em>Some generalizations of the T-method in simultaneous inference</em>. <em>4</em>(2), 224–234.</p>
</div>
<div id="ref-Hochberg.1975">
<p>Hochberg, Y. (1975). <em>An Extension of the T-Method to General Unbalanced Models of Fixed Effects</em>. <em>37</em>(3), 426–433.</p>
</div>
<div id="ref-Holm.1979">
<p>Holm, S. (1979). A Simple Sequentially Rejective Multiple Test Procedure. <em>Scandinavian Journal of Statistics</em>, <em>6</em>(2), 65–70.</p>
</div>
<div id="ref-Lenth.2020">
<p>Lenth, R. (2020). <em>emmeans: Estimated Marginal Means, aka Least-Squares Means</em>. <a href="https://CRAN.R-project.org/package=emmeans">https://CRAN.R-project.org/package=emmeans</a></p>
</div>
<div id="ref-Mair.2020">
<p>Mair, P., &amp; Wilcox, R. R. (2020). Robust statistical methods in R using the WRS2 package. <em>Behavior Research Methods</em>, <em>52</em>(2), 464–488. <a href="https://doi.org/10.3758/s13428-019-01246-w">https://doi.org/10.3758/s13428-019-01246-w</a></p>
</div>
<div id="ref-Toothaker.1993">
<p>Toothaker, L. E. (1993). <em>Multiple Comparison Procedures</em>. SAGE.</p>
</div>
<div id="ref-Tukey.1949">
<p>Tukey, J. W. (1949). Comparing Individual Means in the Analysis of Variance. <em>Biometrics</em>, <em>5</em>(2), 99. <a href="https://doi.org/10.2307/3001913">https://doi.org/10.2307/3001913</a></p>
</div>
<div id="ref-Wilcox.2012">
<p>Wilcox, R. R. (2012). <em>Introduction to robust estimation and hypothesis testing</em> (3. ed.). Elsevier/Academic Press. <a href="http://site.ebrary.com/lib/alltitles/docDetail.action?docID=10521171">http://site.ebrary.com/lib/alltitles/docDetail.action?docID=10521171</a></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
