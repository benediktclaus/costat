<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Faktorielle ANOVA</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="images/broom.ico">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Chamber of Statistics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Allgemeines
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="software.html">Software</a>
    </li>
    <li>
      <a href="r-basics.html">R Basics</a>
    </li>
    <li>
      <a href="stil.html">Stil</a>
    </li>
    <li>
      <a href="pakete.html">Pakete</a>
    </li>
    <li>
      <a href="daten-import.html">Daten-Import</a>
    </li>
    <li>
      <a href="data-wrangling.html">Data Wrangling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Regression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Überblick</li>
    <li class="divider"></li>
    <li>
      <a href="korrelation.html">Korrelation</a>
    </li>
    <li class="dropdown-header">Lineare Regression</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Mittelwerte vergleichen
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mittelwerte-vergleichen.html">Überblick</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">t-Tests</li>
    <li>
      <a href="t-test-einstichprobe.html">Bei einer Stichprobe</a>
    </li>
    <li>
      <a href="t-test-unabhaengig.html">Bei unabhängigen Stichproben</a>
    </li>
    <li>
      <a href="t-test-abhaengig.html">Bei abhängigen Stichproben</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">ANOVAs</li>
    <li>
      <a href="einfaktorielle-anova.html">Einfaktorielle ANOVA</a>
    </li>
    <li>
      <a href="faktorielle-anova.html">Faktorielle ANOVA</a>
    </li>
    <li class="dropdown-header">ANCOVA</li>
    <li>
      <a href="anova-messwiederholung.html">ANOVA mit Messwiederholung</a>
    </li>
    <li class="dropdown-header">Mixed ANOVA</li>
    <li>
      <a href="kontraste.html">Geplante Kontraste</a>
    </li>
    <li>
      <a href="post-hoc-tests.html">Post-hoc-Tests</a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li>
  <a href="effektstaerken.html">Effektstärken</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="voraussetzungen.html">Voraussetzungen im GLM</a>
    </li>
    <li>
      <a href="formelsammlung.html">Formelsammlung</a>
    </li>
    <li>
      <a href="zentraler-grenzwertsatz.html">Zentraler Grenzwertsatz</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Faktorielle ANOVA</h1>

</div>


<p><img src="images/ice-cream_r.jpg" /></p>
<p>Mit einer (allgemeinen) faktoriellen ANOVA kann man mehr als zwei Gruppenmittelwerte in Abhängigkeit von kategorialen Prädiktoren vergleichen. Da die ANOVA ein Omnibus-Test ist, und so nur anzeigt, ob irgendwo ein signifikanter Unterschied zwischen den betrachteten Mittelwerten besteht, nutzt man entweder Kontraste oder Post-hoc-Tests, um herauszufinden, welche Mittelwerte sich letztendlich signifikant voneinander unterscheiden. Zusätzlich kann eine <em>Simple Effects Analysis</em> dazu genutzt werden, Unterschiede auf einzelnen Faktorstufen festzustellen.</p>
<div id="pakete" class="section level1">
<h1>Pakete</h1>
<p>Alle Berechnungen und Abbildungen können wir mit unseren <a href="pakete.html">Standardpaketen</a> durchführen. Wir benötigen das <code>tidyverse</code> zum Data Wrangling und zur Visualisierung der Daten. <code>haven</code> benötigen wir für den Import von SPSS-Dateien und <code>rstatix</code> für statistische Analysen.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(haven)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(rstatix)</span></code></pre></div>
</div>
<div id="beispiel" class="section level1">
<h1>Beispiel</h1>
<p>Jeder liebt es, so viel ist klar. Aber mögen alle Personen jede Sorte Eis gleich gerne? Pfiffige Forscher haben sich an einem schönen Sommertag an einer Eisdile in der Dortmunder Innenstadt platziert und viele zufällig vorbeikommende Passanten vier Eissorten kosten lassen. Die Probanden konnten dann auf einer Skala von 0 – 20 angeben, wie lecker sie die eben probierte Eissorte fanden. Ein höherer Wert bedeutet eine bessere Bewertung. Wir wollen herausfinden, ob die Sorte selbst und das Geschlecht des Verkosters einen Einfluss auf den Geschmack hat. Wichtig ist dabei zu bachten, dass jeder Passant nur <em>eine</em> Eissorte probiert hat.</p>
<div id="klassisch" class="section level2">
<h2>Klassisch</h2>
<p>Die Daten zu diesem Experiment sind im Datensatz <code>ice_cream</code>. In der ersten Spalte (<code>flavor</code>) ist der Geschmack eingetragen, in der zweiten Spalte (<code>sex</code>) das Geschlecht des Verkosters. In der dritten Spalte finden wir unsere abhängige Variable <code>yumminess</code>. Wir berechnen hier also eine 4 <span class="math inline">\(\times\)</span> 2 faktorielle ANOVA mit den Zwischensubjektfaktoren “Eissorte” mit vier Fakorstufen (“Vanilla”, “Chocolate”, “Cookie” und “Champagne”) und “Geschlecht” mit zwei Faktorstufen (“Female” und “Male”).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>costatcompanion<span class="op">::</span>ice_cream</span></code></pre></div>
<pre><code>## # A tibble: 295 x 4
##    id    flavor    sex    yumminess
##    &lt;chr&gt; &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;
##  1 1     Champagne Female        14
##  2 2     Vanilla   Female        19
##  3 3     Champagne Female        16
##  4 4     Chocolate Female        17
##  5 5     Chocolate Female        16
##  6 6     Vanilla   Male          16
##  7 7     Vanilla   Female        17
##  8 8     Vanilla   Male          18
##  9 9     Cookie    Male          13
## 10 10    Champagne Female        13
## # ... with 285 more rows</code></pre>
<div id="voraussetzungen" class="section level3">
<h3>Voraussetzungen</h3>
<p>Da wir uns im GLM bewegen, gelten die üblichen <a href="voraussetzungen.html">Voraussetzungen</a>.</p>
</div>
<div id="eda" class="section level3">
<h3>EDA</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Deskriptive Statistiken zur Eissorte...</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>ice_cream <span class="op">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">group_by</span>(flavor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="kw">get_summary_stats</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 x 14
##   flavor variable     n   min   max median    q1    q3   iqr   mad  mean    sd
##   &lt;fct&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Vanil~ yummine~    74    11    20   17    15      18  3     2.96  16.6  2.18
## 2 Choco~ yummine~    81    12    20   17    16      18  2     1.48  17.2  1.68
## 3 Cookie yummine~    80     8    20   14.5  12.8    17  4.25  3.71  14.6  2.83
## 4 Champ~ yummine~    60     2    20   14    11      15  4     2.96  13.2  3.64
## # ... with 2 more variables: se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># ...zur Verteilung der Geschlechter...</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>ice_cream <span class="op">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">group_by</span>(sex) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">get_summary_stats</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 x 14
##   sex   variable     n   min   max median    q1    q3   iqr   mad  mean    sd
##   &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Fema~ yummine~   162    10    20     17    15    18     3  2.96  16.4  2.21
## 2 Male  yummine~   133     2    20     15    12    17     5  4.45  14.5  3.51
## # ... with 2 more variables: se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># ...und zu den Eissorten für jedes Geschlecht</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>ice_cream <span class="op">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">group_by</span>(flavor, sex) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">get_summary_stats</span>()</span></code></pre></div>
<pre><code>## # A tibble: 8 x 15
##   flavor sex   variable     n   min   max median    q1    q3   iqr   mad  mean
##   &lt;fct&gt;  &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Vanil~ Fema~ yummine~    36    12    20     17 16       19  3     2.22  17.1
## 2 Vanil~ Male  yummine~    38    11    20     16 15       18  3     2.22  16.1
## 3 Choco~ Fema~ yummine~    41    13    20     17 16       18  2     1.48  17.2
## 4 Choco~ Male  yummine~    40    12    20     17 16       18  2     1.48  17.1
## 5 Cookie Fema~ yummine~    45    10    20     16 14       18  4     2.96  16.1
## 6 Cookie Male  yummine~    35     8    18     13 11.5     14  2.5   1.48  12.8
## 7 Champ~ Fema~ yummine~    40    11    20     15 14       17  3     1.48  15.2
## 8 Champ~ Male  yummine~    20     2    13     10  8.75    11  2.25  1.48   9.2
## # ... with 3 more variables: sd &lt;dbl&gt;, se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
<p>Wir haben Daten zu vier Eissorten. Verköstigt wurden am häufigsten Schokolade (<span class="math inline">\(n = 81\)</span>) und Cookie (<span class="math inline">\(n = 80\)</span>); bewertet wurden am besten Vanille (<span class="math inline">\(M = 16.57, SD = 2.18\)</span>) und Schokolade (<span class="math inline">\(M = 17.16, SD = 1.68\)</span>). Insgesamt haben <span class="math inline">\(N = 295\)</span> Passanten an der Untersuchung teilgenommen, wovon <span class="math inline">\(n = 162\)</span> Frauen und <span class="math inline">\(n = 133\)</span> Männer waren.</p>
<p><img src="faktorielle-anova_files/figure-html/unnamed-chunk-7-1.png" width="2450" style="display: block; margin: auto;" /></p>
<p>Aufgrund der Abbildung bekommen wir eine grobe Idee davon, dass die untersuchten Frauen alle Eissorten in etwa gleich lecker fanden. Die Männer jedoch stehen weniger auf Cookie und überhaupt nicht auf Champagner. (Bah!) Jetzt ist die Frage, ob unsere Einschätzung, dass sich die Mittelwerte tatsächlich signifikant unterscheiden, richtig ist. Dafür berechnen wir die ANOVA.</p>
</div>
<div id="durchführung" class="section level3">
<h3>Durchführung</h3>
<p>Auch hier haben wir, wie bei der <a href="einfaktorielle-anova.html">einfaktoriellen ANOVA</a>, zwei Möglichkeiten, die Funktionsargumente einzugeben. Einmal als Formelschreibweise und einmal als Explizite Nennung in Form der Funktionsargumente. <a href="https://github.com/kassambara/rstatix/issues/40">Momentan sind die Ergebnisse für die Definition in Formelschreibweise falsch (CRAN-Version 0.5.0)</a>, deshalb sollte man die Faktoren explizit als Funktionsargumente angeben. Wichtig ist hierbei, dass das Funktionsargument <code>type = 3</code> angegeben wird. In der Psychologie (und generell in den Sozialwissenschaften und der Medizin) werden standardmäßig <a href="http://md.psych.bio.uni-goettingen.de/mv/unit/lm_cat/lm_cat_unbal_ss_explained.html">Quadratsummen vom Typ “III”</a> berechnet.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Formelschreibweise</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>ice_cream <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">anova_test</span>(yumminess <span class="op">~</span><span class="st"> </span>flavor<span class="op">*</span>sex, <span class="dt">type =</span> <span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># Funktionsargumente</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>ice_cream <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="st">  </span><span class="kw">anova_test</span>(<span class="dt">dv =</span> yumminess, <span class="dt">between =</span> <span class="kw">c</span>(flavor, sex), <span class="dt">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Dieses Vorgehen liefert uns folgendes Resultat.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>ice_cream <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">anova_test</span>(<span class="dt">dv =</span> yumminess, <span class="dt">between =</span> <span class="kw">c</span>(flavor, sex), <span class="dt">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## ANOVA Table (type III tests)
## 
##       Effect DFn DFd       F        p p&lt;.05   ges
## 1     flavor   3 287  73.263 3.28e-35     * 0.434
## 2        sex   1 287 106.711 1.78e-21     * 0.271
## 3 flavor:sex   3 287  25.377 1.37e-14     * 0.210</code></pre>
<p>An dieser Stelle lohnt es sich etwas, auf die Interpretation der Ergebnisse einzugehen. In den Zeilen <code>flavor</code> und <code>sex</code> sind die Haupteffekte dieser beiden Faktoren zu finden. Hat der Faktor “flavor” (= Eissorte) allein einen Einfluss auf die Einschätzung der Probanden? Ja, der Haupteffekt für “flavor” ist signifikant, da <span class="math inline">\(p &lt; .05\)</span>. Das gleiche gilt für den Haupteffekt, und somit Einfluss, von “sex” (= Geschlecht); auch hier ist <span class="math inline">\(p &lt; .05\)</span>. In der dritten Zeile finden wir den <strong>Interaktionseffekt</strong> von “flavor” und “sex”. Mit diesem wird also angegeben, ob es zwischen den beiden Faktoren eine Interaktion gibt. Eine Interaktion würde bedeuten, dass der Faktor “flavor” die abhängige Variable “yumminess” nicht in allen Faktorstufen von “sex” gleich beeinflusst. Der Einfluss von “flavor” auf “yumminess” wäre also zwischen den Geschlechtern unterschiedlich. Man kann das natrülich auch andersrum sagen: Der Interaktionseffekt gibt an, ob der Einfluss des Faktors “sex” auf “yumminess” in allen Faktorstufen von “flavor” gleich ist. Hier ist der ebenfalls signifikant, da <span class="math inline">\(p &lt; .05\)</span>.</p>
<p>Bei diesem Versuch einer Beschreibung des Interaktionseffekts kann einem der Kopf rauchen. Deshalb ist es immer sinnvoll, sich die Daten in Diagrammen anzuschauen. Unten findest du die Daten auf zwei unterschiedliche Weisen präsentiert: Einmal ist “flavor” auf der <span class="math inline">\(x\)</span>-Achse und die Linien sind getrennt nach “sex” (A; diese Abbildung sollte Dir bekannt vorkommen, weil sie identisch mit der oberen ist). Das andere Mal ist “sex” auf der <span class="math inline">\(x\)</span>-Achse und die Linien sind nach “flavor” getrennt (B).</p>
<p><img src="faktorielle-anova_files/figure-html/unnamed-chunk-10-1.png" width="2450" style="display: block; margin: auto;" /></p>
<p>Diese Abbildungen zeigen beide denselben Sachverhalt, nur “von einer anderen Seite”. Welche Seite man darstellen sollte, hängt von verschiedenen Faktoren ab. Einerseits natürlich von der untersuchten Fragestellung. In diesem Fall wollten wir untersuchen, ob sich die “yumminess” von Eissorten unterscheidet, also haben wir die Eissorten auf die <span class="math inline">\(x\)</span>-Achse gepackt. Zusätzlich dazu interessierte uns der Einfluss des Geschlechts, anhand dessen wir dann die Linien getrennt haben. Hätten wir uns jedoch eher gefragt, ob sich Frauen oder Männer generell in ihrer Einschätzung der Eissorten-“yumminess” unterscheiden, hätten wir wahrscheinlich “sex” auf die <span class="math inline">\(x\)</span>-Achse schmeißen können, genau wie in Abbildung B.</p>
<p>Andererseits ist es wichtig auf dem Schirm zu haben, was das menschliche Gehirn noch verstehen und analysieren kann. Wir sind zwar mit einer großen rechenleistung ausgestattet, aber Bilder vermögen uns doch auch zu täuschen oder zu verwirren. Genrell kann man sagen, <strong>dass ein Interaktionseffekt vorliegt, wenn die eingezeichneten Linien nicht parallel verlaufen</strong>. Aus welcher Abbildung das besser hervorgeht, sollte man immer im Einzelfall entscheiden.</p>
<p>Wir haben jetzt also geklärt, dass ein Interaktionseffekt vorliegt. Nun sind beide Haupteffekte signifikant und der Interaktionseffekt noch dazu. Was bedeutet das jetzt? Irgendwie haben also die Eissorte und das Geschlecht der Passanten (“flavor” und “sex”) einen Einfluss auf die “yumminess” (als Haupteffekte), aber dieser Einfluss variiert, je nach Geschmack oder Geschlecht (Interaktionseffekt)?! Im Prinzip kann man sagen: Jap, genau. Und an dieser Stelle wird deutlich, was viele falsch machen, denn <strong>die Interpretation von Haupteffekten bei einem signifikanten Interaktionseffekt ist sinnlos</strong>. Statistisch sind die Haupteffekte zwar signifikant (ignoriert man das Geschlecht, hat also die Eissorte im Mittel einen Einfluss auf die “yumminess” und ignoriert man die Eissorte, hat Geschlecht im Mittel einen Einfluss auf die “yumminess”), aber diese Effekte <em>variieren</em> ja gerade in Abhängigkeit von den jeweiligen Faktorstufen, was uns der signifikante Interaktionseffekt ja mitteilt. Bei einem signifikanten Interaktionseffekt konzentrieren wir uns also nur auf diesen.</p>
<p>Aus Abbildung A können wir entnehmen, dass Frauen alle Eissorten ungefähr gleich gut einschätzten, die “yumminess” lag im Durchschnitt immer über 15. Männer hingegen hatten deutlichere Präferenzen: Bei Vanielle und Schokolade hielten sie noch mit und schätzten diese beiden Sorten ähnlich wie die Frauen ein, aber bei Cookie und spätestens bei Champagner war das Spiel vorbei. Diese beiden Sorten wurden von den Männern deutlich schlechter eingeschätzt als von den Frauen. Gibt es eine Möglichkeit herauszufinden, bei welcher Faktorstufe von “falvor” sich Frauen und Männer signifikant unterscheiden? Ja, die <em>Simple Effects Analysis</em>.</p>
</div>
<div id="simple-effects-analysis" class="section level3">
<h3>Simple Effects Analysis</h3>
<p>Hier unterscheiden sich alle bekannten Statistik-Programme erheblich darin, ob diese Analyse überhaupt durchgeführt werden kann. Natürlich können wir das in R machen. JASP-Nutzer können diese Analyse ebenfalls ausfählen. SPSS-Nutzer müssen sich mit der Syntax auskennen und ihn dort von Hand eintragen, weil der Befehl nicht in den Dialogfeldern zu finden ist.</p>
<p>Bei der <em>Simple Effect Analysis</em> sollte beachtet werden, ob die Voraussetzung der Varianzhomogenität erfüllt ist. Einfach gesagt nehmen wir uns nämlich nun die Daten für jede einzelne Faktorstufe von “flavor”, berechnen eine ANOVA und untersuchen so, ob sich das Geschlecht für jede Faktorstufe unterscheidet. Ist die Voraussetzung der Varianzhomogenität gegeben, unterscheiden sich die Varianzen der Faktorstufen also nicht signifikant voneinander (= nicht signifikanter Levene-Test; wie in diesem Fall), dann sollten die Fehler des gesamten Modells einbezogen werden <span class="citation">(Bibby, <a href="#ref-Bibby.2010" role="doc-biblioref">2010</a>)</span>. Sind die Varianzen jedoch signifikant unterschiedlich, sollten getrennte ANOVAs pro Faktorstufe berechnet werden.</p>
<div id="varianzhomogenität-angenommen" class="section level4">
<h4>Varianzhomogenität angenommen</h4>
<p>Bei angenommener Varianzhomogenität sollen wir also die “Fehler des Gesamtmodells” berücksichtigen. Zu Beginn müssen wir somit unser Gesamtmodell definieren. Da wir uns im GLM, also im allgemeinen linearen Modell bewegen, ist unser Modell immer eine Form des linearen Modells, das in R mit <code>lm()</code> definiert wird. Mit der Formelschreibweise setzen wir das so um.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>main_model &lt;-<span class="st"> </span><span class="kw">lm</span>(yumminess <span class="op">~</span><span class="st"> </span>flavor <span class="op">*</span><span class="st"> </span>sex, <span class="dt">data =</span> ice_cream)</span></code></pre></div>
<p>Nun gehen wir genau so vor wie beschrieben und berechnen für jede Faktorstufe von “flavor” ganz normale ANOVAs, geben als Fehlerterme jedoch die des Gesamtmodells (<code>main_model</code>) an. Wir untersuchen an dieser Stelle also den Einfluss von “sex” auf “yumminess” für alle Faktorstufen von “flavor”.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>ice_cream <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw">group_by</span>(flavor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">anova_test</span>(yumminess <span class="op">~</span><span class="st"> </span>sex, <span class="dt">error =</span> main_model)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   flavor    Effect   DFn   DFd       F        p `p&lt;.05`       ges
##   &lt;fct&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
## 1 Vanilla   sex        1   287   4.22  4.10e- 2 &quot;*&quot;     0.015    
## 2 Chocolate sex        1   287   0.023 8.81e- 1 &quot;&quot;      0.0000785
## 3 Cookie    sex        1   287  48.4   2.35e-11 &quot;*&quot;     0.144    
## 4 Champagne sex        1   287 110.    6.18e-22 &quot;*&quot;     0.276</code></pre>
<p>Damit erhalten wir eine Übersicht über alle vier durchgeführten ANOVAs, in denen der Einfluss von “sex” auf “yumminess” untersucht wurde. Die weiblichen und männlichen Verkoster unterschieden sich demnach in der Einschätzung der “yumminess” bei den Sorten Vanille, Cookie und Champagner.</p>
</div>
<div id="varianzhomogenität-nicht-angenommen" class="section level4">
<h4>Varianzhomogenität nicht angenommen</h4>
<p>Nehmen wir keine Varianzhomogenität an, berechnen wir wieder für die einzelnen Faktorstufen getrennte ANOVAs, verzichten jedoch auf die Angabe der Fehlerterme.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>ice_cream <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span><span class="kw">group_by</span>(flavor) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span><span class="kw">anova_test</span>(yumminess <span class="op">~</span><span class="st"> </span>sex)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 8
##   flavor    Effect   DFn   DFd      F        p `p&lt;.05`      ges
##   &lt;fct&gt;     &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
## 1 Vanilla   sex        1    72  4.1   4.70e- 2 &quot;*&quot;     0.054   
## 2 Chocolate sex        1    79  0.035 8.52e- 1 &quot;&quot;      0.000443
## 3 Cookie    sex        1    78 40.0   1.48e- 8 &quot;*&quot;     0.339   
## 4 Champagne sex        1    58 94.1   9.37e-14 &quot;*&quot;     0.619</code></pre>
</div>
<div id="effect_size" class="section level4">
<h4>Effektstärke</h4>
<p>Auch für die <em>Simple Effects Analysis</em> lassen sich Effektstärken für die einzelnen Vergleiche berechnen. Diese ergeben sich, wenn innerhalb der Faktorstufen nur zwei Gruppen miteinander vergleichen werden, als <span class="math display">\[r = \sqrt{\dfrac{F(1, df_\text{d})}{F(1, df_\text{d}) + df_\text{d}}}\]</span> mit <span class="math inline">\(df_\text{d}\)</span> als Freiheitsgrade der Fehler.</p>
<p>In diesem Beispiel haben wir Varianzhomogenität angenommen, da der Levene-Test nicht signifikant war. Die Effektstärke zwischen Frauen und Männern für den Geschmack Vanille ist somit <span class="math display">\[r = \sqrt{\dfrac{4.22}{4.22 + 287}}\]</span> also 0.12. Für die übrigen Faktorstufen von “flavor” finden wir</p>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#lvmipwvwyd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lvmipwvwyd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lvmipwvwyd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lvmipwvwyd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lvmipwvwyd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lvmipwvwyd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lvmipwvwyd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lvmipwvwyd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lvmipwvwyd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lvmipwvwyd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lvmipwvwyd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lvmipwvwyd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#lvmipwvwyd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lvmipwvwyd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lvmipwvwyd .gt_from_md > :first-child {
  margin-top: 0;
}

#lvmipwvwyd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lvmipwvwyd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lvmipwvwyd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#lvmipwvwyd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lvmipwvwyd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#lvmipwvwyd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lvmipwvwyd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lvmipwvwyd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lvmipwvwyd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lvmipwvwyd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#lvmipwvwyd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lvmipwvwyd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#lvmipwvwyd .gt_left {
  text-align: left;
}

#lvmipwvwyd .gt_center {
  text-align: center;
}

#lvmipwvwyd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lvmipwvwyd .gt_font_normal {
  font-weight: normal;
}

#lvmipwvwyd .gt_font_bold {
  font-weight: bold;
}

#lvmipwvwyd .gt_font_italic {
  font-style: italic;
}

#lvmipwvwyd .gt_super {
  font-size: 65%;
}

#lvmipwvwyd .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="lvmipwvwyd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Faktorstufe</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">r</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_center">Vanilla</td>
      <td class="gt_row gt_right">0.12</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Chocolate</td>
      <td class="gt_row gt_right">0.01</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Cookie</td>
      <td class="gt_row gt_right">0.38</td>
    </tr>
    <tr>
      <td class="gt_row gt_center">Champagne</td>
      <td class="gt_row gt_right">0.53</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
</div>
<div id="berichten" class="section level3">
<h3>Berichten</h3>
<p>We found the yumminess of ice-cream to be dependent on both, flavor and sex, as the interaction effect was significant, <span class="math inline">\(F(3, 287) = 25.38, p &lt; .001, \eta_G^2 = .21\)</span>. To break down the interaction effect, we conducted a simple effects analysis and compared the estimated yumminess per flavor between sexes. The only non-significant difference between the sexes was found for the flavor “chocolate”, <span class="math inline">\(F(1, 287) = 0.02, p = .881, r = .01\)</span>. The sex differences for all other flavor were statistically significant (<span class="math inline">\(p \leq .041\)</span>) with a small effect vor “vanilla” (<span class="math inline">\(r = .12\)</span>) und large effects for “cookie” (<span class="math inline">\(r = .41\)</span>) and “champagne” (<span class="math inline">\(r = .61\)</span>).</p>
</div>
</div>
<div id="robust" class="section level2">
<h2>Robust</h2>
<p>Auch für faktorielle ANOVAs hat <span class="citation">Wilcox (<a href="#ref-Wilcox.2017" role="doc-biblioref">2017</a>)</span> vorgesorgt. Für zweifaktorielle ANOVAs (wie in diesem Falle) dürfen wir uns aus dem Paket <code>WRS2</code> <span class="citation">(Mair &amp; Wilcox, <a href="#ref-Mair.2020" role="doc-biblioref">2020</a>)</span> der Funktion <code>t2way()</code> mit <code>mcp2atm()</code> als Post-hoc-Test bedienen, bei dreifaktoriellen ANOVAs dann jedoch <code>t3way()</code>. Höhere Designs werden derzeit nicht unterstützt, was aber kein Problem ist, da uns vier- oder mehrfaktorielle ANOVAs in der freien Wildbahn in der Regel nicht begegnen. Das hängt damit zusammen, dass die Modelle pro Faktor exponentiell komplizierter werden, und somit umso schwerer zu verstehen. Bei einer einfaktoriellen ANOVA wird ein für uns interessanter Effekt geschätzt: Der Haupteffelt des einen Faktors. Bei einer zweifaktoriellen ANOVA gibt es schon drei interessante Effekte: Jeweils den Haupteffekt der Faktoren und deren Interaktionseffekt. Bei dreifaktoriellen ANOVAs gibt es die drei Haupteffekte der Faktoren und alle möglichen Interaktionseffekte, also drei Interaktionseffekte zwischen jeweils zwei Faktoren und einen riesigen Interaktionseffekt zwischen llen drei Faktoren, was in der Summe 7 Effekte gibt. Das dann vernünftig zu interpretieren und darzustellen kann eine Herausforderung sein, die Forscher im Rahmen eines ungeschriebenen Gesetzes anscheinend nicht eingehen.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">library</span>(WRS2)</span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co"># Robuste zweifaktorielle ANOVA</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw">t2way</span>(yumminess <span class="op">~</span><span class="st"> </span>flavor <span class="op">*</span><span class="st"> </span>sex, <span class="dt">data =</span> ice_cream)</span></code></pre></div>
<pre><code>## Call:
## t2way(formula = yumminess ~ flavor * sex, data = ice_cream)
## 
##               value p.value
## flavor     251.7609   0.001
## sex         86.2149   0.001
## flavor:sex  82.1532   0.001</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Robuster Post-hoc-Test für eine zweifaktorielle ANOVA</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">mcp2atm</span>(yumminess <span class="op">~</span><span class="st"> </span>flavor <span class="op">*</span><span class="st"> </span>sex, <span class="dt">data =</span> ice_cream)</span></code></pre></div>
<pre><code>## Call:
## mcp2atm(formula = yumminess ~ flavor * sex, data = ice_cream)
## 
##                psihat ci.lower ci.upper p-value
## flavor1      -0.25926 -0.88143  0.36291 0.24884
## flavor2      -0.22222 -0.89690  0.45246 0.36767
## flavor3       0.33333 -0.36461  1.03128 0.19534
## flavor4       0.03704 -0.26093  0.33500 0.72777
## flavor5       0.59259  0.23646  0.94873 0.00007
## flavor6       0.55556  0.10689  1.00422 0.00138
## sex1          0.88889  0.33913  1.43865 0.00204
## flavor1:sex1  0.25926 -0.36291  0.88143 0.24884
## flavor2:sex1  0.22222 -0.45246  0.89690 0.36767
## flavor3:sex1 -0.33333 -1.03128  0.36461 0.19534
## flavor4:sex1 -0.03704 -0.33500  0.26093 0.72777
## flavor5:sex1 -0.59259 -0.94873 -0.23646 0.00007
## flavor6:sex1 -0.55556 -1.00422 -0.10689 0.00138</code></pre>
<p>Auch bei uns ist der Interaktionseffekt (neben den Haupteffekten) signifikant, <span class="math inline">\(\hat{\Psi} = 82.15, p = .001\)</span>. Der Output der Post-hoc-Tests ist allein für sich erstmal ziemlich kryptisch, welche Effekte wurden da getestet? Wenn wir den Befehl als Objekt abspeichern, können wir uns die Kontrastmatrix genauer ansehen.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>ice_post_hocs &lt;-<span class="st"> </span><span class="kw">mcp2atm</span>(yumminess <span class="op">~</span><span class="st"> </span>flavor <span class="op">*</span><span class="st"> </span>sex, <span class="dt">data =</span> ice_cream)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>ice_post_hocs<span class="op">$</span>contrasts</span></code></pre></div>
<pre><code>##                  flavor1 flavor2 flavor3 flavor4 flavor5 flavor6 sex1
## Vanilla_Female         1       1       1       0       0       0    1
## Vanilla_Male           1       1       1       0       0       0   -1
## Chocolate_Female      -1       0       0       1       1       0    1
## Chocolate_Male        -1       0       0       1       1       0   -1
## Cookie_Female          0      -1       0      -1       0       1    1
## Cookie_Male            0      -1       0      -1       0       1   -1
## Champagne_Female       0       0      -1       0      -1      -1    1
## Champagne_Male         0       0      -1       0      -1      -1   -1
##                  flavor1:sex1 flavor2:sex1 flavor3:sex1 flavor4:sex1
## Vanilla_Female              1            1            1            0
## Vanilla_Male               -1           -1           -1            0
## Chocolate_Female           -1            0            0            1
## Chocolate_Male              1            0            0           -1
## Cookie_Female               0           -1            0           -1
## Cookie_Male                 0            1            0            1
## Champagne_Female            0            0           -1            0
## Champagne_Male              0            0            1            0
##                  flavor5:sex1 flavor6:sex1
## Vanilla_Female              0            0
## Vanilla_Male                0            0
## Chocolate_Female            1            0
## Chocolate_Male             -1            0
## Cookie_Female               0            1
## Cookie_Male                 0           -1
## Champagne_Female           -1           -1
## Champagne_Male              1            1</code></pre>
<p>Das sieht jetzt aufgrund der Anzahl der Kontraste und des geringen Platzes nicht gerade schön aus, ist aber informativ. Aus dem eigentlichen Funktionsaufruf können wir erkennen, dass der Effekt “flavor5” signifikant ist (<span class="math inline">\(\hat{\Psi} = 0.593, p &lt; .001\)</span>). Aus der Kontrastmatrix können wir aus der Spalte “flavor5” entnehmen, dass hier die Eissorten Schokolade und Champagner miteinander vergleichen wurden. Da dieser Kontrast signifikant ist, ist auch der “Unterschied zwischen diesen beiden Sorten sgnifikant.”yumminess“-Unterschied zwischen diesen beiden Sorten signifikant. Dasselbe trifft auf den Unterschied zwischen Cookie und Champagner zu (Kontrast”flavor 6“). Das sind im Prinzip die Post-hoc-Tests für den Haupteffekt”flavor“. Der Kontrast für den Haupteffekt”sex" (“sex1”) ist ebenfalls signifikant, also unterscheiden sich auch die Geschlechter in ihren “yumminess”-Einschätzungen signifikant voneinander. So viel wissen wir schon; die Ergebnisse sind identisch mit denen unserer klassischen ANOVA. Bezüglich der Interaktionseffekte gibt es nur zwei, die signifikant geworden sind, nämlich “flavor5:sex” (<span class="math inline">\(\hat{\Psi} = -0.593, p &lt;.001\)</span>) und “flavor6:sex” (<span class="math inline">\(\hat{\Psi} = -0.556, p = .001\)</span>). Der erste signifikante Kontrast sagt uns, dass sich der Unterschied zwischen Schokolade und Champagner zwischen den Geschlechtern signifikant unterscheidet. Frauen haben Schokolade und Chmpagner als weniger unterschiedlich eingeschätzt als die Männer (die Richtung dieses Kontrasts muss man sich aus den Abbildungen oder deskriptiven Statistiken fischen; der signifikanter Interaktionseffekt gibt nur an, dass etwas unterschiedlich ist). Dasselbe finden wir beim letzten Kontrast: Der Unterschied zwischen Cookie und Champagner wurde von beiden Geschlechtern ebenfalls unterschiedlich eingeschätzt. Auch hier wurde der Unterschied in der “yumminess” zwischen Cookie und Champagner von Frauen geringer eingeschätzt als von den Männern.</p>
</div>
<div id="non-parametrisch" class="section level2">
<h2>Non-parametrisch</h2>
<p>Gibbet nicht.</p>
</div>
</div>
<div id="aus-der-praxis" class="section level1">
<h1>Aus der Praxis</h1>
<p><span class="citation">Wood et al. (<a href="#ref-Wood.1977" role="doc-biblioref">1977</a>)</span> untersuchten Risikofaktoren für kardiovaskuläre Erkrankungen (also irgendwas was mit Herz). Unter anderem untersuchten sie hobbymäßige Läufer (mindestens 15 Meilen pro Woche) und den eher faulen Couch-Typ. Diese beiden Gruppen setzten sie für 6 Minuten auf einen Heimtrainer und maßen dann die Herzrate ind Schlägen pro Minute (bpm). <span class="citation">Moore et al. (<a href="#ref-Moore.2017" role="doc-biblioref">2017</a>)</span> haben die Daten aufbereitet und in der <a href="https://jasp-stats.org/wp-content/uploads/2019/11/The_JASP_Data_Library__version_2-1.pdf">JASP Data Library</a> zur Verfügung gestellt. Hier findet Ihr sie in der Datei <code>heart_rate.csv</code>. In der ersten Spalte (<code>Gender</code>) ist das Geschlecht der Versuchspersonen eingetragen, in der zweiten Spalte (<code>Group</code>) die Angabe dazu, ob es sich bei dieser Versuchsperson um einen Läufer handelte, oder nicht. In der dritten Spalte (<code>Heart Rate</code>) ist die abhängige Variable “Herzrate” zu finden.</p>
<p>Insgesamt wollen wir eine 2 <span class="math inline">\(\times\)</span> 2 faktorielle Varianzanalyse mit den Zwischensubjektfaktoren Geschlecht (weiblich vs. männlich) und Gruppe (Kontrollgruppe vs. Läufer) berechnen.</p>
<p>Da wir echt unsaubere Variablennamen haben (teilweise mit Leerzeichen), beginnen wir damit, den Datensatz zu importieren und die Namen zu bereinigen. Zu Beginn sind sowohl <code>gender</code> als auch <code>group</code> noch Zeichenfolgen (Typ = <code>&lt;chr&gt;</code>), wir wollen diese jedoch als Faktoren, was wir mit <code>mutate()</code> umsetzen.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>runners &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/heart_rate.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>janitor<span class="op">::</span><span class="kw">clean_names</span>()</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Gender = col_character(),
##   Group = col_character(),
##   `Heart Rate` = col_double()
## )</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>runners &lt;-<span class="st"> </span>runners <span class="op">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">mutate_if</span>(is_character, as_factor)</span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a>runners</span></code></pre></div>
<pre><code>## # A tibble: 800 x 3
##    gender group   heart_rate
##    &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;
##  1 Female Runners        119
##  2 Female Runners         84
##  3 Female Runners         89
##  4 Female Runners        119
##  5 Female Runners        127
##  6 Female Runners        111
##  7 Female Runners        115
##  8 Female Runners        109
##  9 Female Runners        111
## 10 Female Runners        120
## # ... with 790 more rows</code></pre>
<p>Dabei kommt mir ein kleiner, aber feiner Verdacht. Wenn wir uns die ersten paar Zeilen des Datensatzes anschauen, stellen wir fest, dass die ersten Probanden zur Gruppe der “Runners” gehörten. Die Funktion <code>as_factor()</code> wandelt diese Zeichenfolge in einen ordentlichen Faktor um und ordnet die Faktorlevels nach erstmaligem Auftreten dieses Faktors. Die Variable <code>group</code> hat nur zwei Level: “Runners” und “Control”. Da “Runners” direkt zu Beginn unseres Datensatzes kam, sind diese wahrscheinlich auch das erste Level. Wir können das schnell überprüfen, indem wir uns die Faktorlevels für die Variable <code>group</code> ausgeben lassen.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span><span class="kw">pull</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">levels</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Runners&quot; &quot;Control&quot;</code></pre>
<p>Siehe da, die “Runners” kommen in der Reienfolge der Faktorlevels zuerst und erst danach die “Controls”. Das ist kein großes Problem, alle Analysen können wir durchführen, ohne an der Reihenfolge der Faktoren irgendetwas zu ändern, aber zu einem guten Stil sollte es gehören, die Level – insofern möglich – logisch zu ordnen. R behandelt das erste Faktorlevel in der Regel als Kontrollgruppe, z.B. bei Kontrasten. Deshalb ist es eine gute Idee, jegliche Form von Kontrollgruppe immer als erstes Faktorlevel zu definieren. Da wir in diesem Fall nur zwei Faktorlevel haben, können wir das einfach mit der Funktion <code>fct_rev()</code> bewerkställigen, die die Reihenvolge der Level einfach umkehrt<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>runners &lt;-<span class="st"> </span>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group =</span> <span class="kw">fct_rev</span>(group))</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="st">  </span><span class="kw">pull</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="st">  </span><span class="kw">levels</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Control&quot; &quot;Runners&quot;</code></pre>
<p>Nach diesem Schritt können wir uns die Daten etwas genauer anschauen.</p>
<div id="klassisch-1" class="section level2">
<h2>Klassisch</h2>
<div id="eda-1" class="section level3">
<h3>EDA</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  </span><span class="kw">get_summary_stats</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 x 14
##   gender variable     n   min   max median    q1    q3   iqr   mad  mean    sd
##   &lt;fct&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Female heart_r~   400    78   196    132  115    148  33    25.2  132.  22.7
## 2 Male   heart_r~   400    69   172    115  102.   130  28.2  22.2  117.  19.8
## # ... with 2 more variables: se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">  </span><span class="kw">get_summary_stats</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 x 14
##   group variable     n   min   max median    q1    q3   iqr   mad  mean    sd
##   &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Cont~ heart_r~   400    77   196    139   127   152    25  19.3  139   19.0
## 2 Runn~ heart_r~   400    69   164    109    98   120    22  16.3  110.  15.5
## # ... with 2 more variables: se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="st">  </span><span class="kw">group_by</span>(gender, group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="st">  </span><span class="kw">get_summary_stats</span>()</span></code></pre></div>
<pre><code>## # A tibble: 4 x 15
##   gender group variable     n   min   max median    q1    q3   iqr   mad  mean
##   &lt;fct&gt;  &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Female Cont~ heart_r~   200   105   196    147   137   160    23  16.3  148 
## 2 Female Runn~ heart_r~   200    78   164    116   106   126    20  14.8  116.
## 3 Male   Cont~ heart_r~   200    77   172    130   119   142    23  16.3  130 
## 4 Male   Runn~ heart_r~   200    69   146    103    96   112    16  11.9  104.
## # ... with 3 more variables: sd &lt;dbl&gt;, se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>runners</span></code></pre></div>
<pre><code>## # A tibble: 800 x 3
##    gender group   heart_rate
##    &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;
##  1 Female Runners        119
##  2 Female Runners         84
##  3 Female Runners         89
##  4 Female Runners        119
##  5 Female Runners        127
##  6 Female Runners        111
##  7 Female Runners        115
##  8 Female Runners        109
##  9 Female Runners        111
## 10 Female Runners        120
## # ... with 790 more rows</code></pre>
<p>Insgesamt wurden unglaubliche <span class="math inline">\(N = 800\)</span> Probanden getestet. Diese teilten sich auf in jeweils <span class="math inline">\(n = 400\)</span> Männer und Frauen und jeweils <span class="math inline">\(n = 400\)</span> Läufer und Kontroll-Probanden, wodurch jede “Zelle” (Kombination aus Geschlecht und Gruppe) aus <span class="math inline">\(n = 200\)</span> Probanden bestand.</p>
<p><img src="faktorielle-anova_files/figure-html/unnamed-chunk-22-1.png" width="2450" style="display: block; margin: auto;" /></p>
<p>Wir sehen schon bestimmte Trends dahingehend, dass Frauen nach einem kurzen Heimtrainer-Training generell eine höhere Herzrate haben als Männer. Außerdem scheinen die Sportler darüberhinaus eine geringere Herzrate als Stubenhocker (die Kontrollgruppe) zu haben. Zur Varianzhomogenität können wir aus der Abbildung wenig entnehmen, wir sollten also den Levene-Test berechnen. Bei <span class="math inline">\(N = 800\)</span> Probanden können wir jedoch vorab eine gute Schätzung dazu abgeben, ob dieser signifikant sein wird, oder nicht…</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">levene_test</span>(heart_rate <span class="op">~</span><span class="st"> </span>gender <span class="op">*</span><span class="st"> </span>group)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##     df1   df2 statistic        p
##   &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1     3   796      5.73 0.000697</code></pre>
<p>Oh Wunder, er ist signifikant, da <span class="math inline">\(p &lt; .05\)</span>. Der Spaß mit der klassischen ANOVA wäre hier somit vorbei (da wir eigentlich Varianzhomogenität und somit einen <em>nicht</em> signifikanten Levene-Test bräuchten) und wir müssten robust weiterrechnen, <a href="#beispiel_robust">was wir unten auch tun</a>. Rebellen, wie wir sind, rechnen wir trotzdem einfach mal weiter und schauen, ob die Zivilisation um uns zusammenbricht.</p>
</div>
<div id="durchführung-1" class="section level3">
<h3>Durchführung</h3>
<p>Die Durchführung ist wie immer kurz und schmerzlos.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="st">  </span><span class="kw">anova_test</span>(<span class="dt">dv =</span> heart_rate, <span class="dt">between =</span> <span class="kw">c</span>(gender, group), <span class="dt">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## ANOVA Table (type III tests)
## 
##         Effect DFn DFd       F         p p&lt;.05   ges
## 1       gender   1 796 185.980  3.29e-38     * 0.189
## 2        group   1 796 695.647 1.15e-110     * 0.466
## 3 gender:group   1 796   7.409  7.00e-03     * 0.009</code></pre>
<p>Sowohl beide Haupteffekte als auch der Interaktionseffekt (<span class="math inline">\(F(1, 796) = 7.41, p = .007\)</span>) sind signifikant. Im Falle eines signifikanten Interaktionseffekts, beschränken wir unsere Interpretation immer auf diesen. Der Unterschied zwischen der Kontrollgruppe und den Läufern ist also zwischen den Geschlechtern signifikant verschieden. Anders gesagt: Die Linien in der Abbildung verlaufen (signifikant) nicht parallel. Um diesen weiter nachzuvollziehen, können wir eine <em>Simple Effects Analysis</em> berechnen. Da die Voraussetzung der Varianzhomogenität nicht gegeben ist, empfiehlt uns <span class="citation">Bibby (<a href="#ref-Bibby.2010" role="doc-biblioref">2010</a>)</span>, pro Faktorstufe eine einfaktorielle ANOVA zu berechnen. Wir können uns entscheiden, anhand welchen Faktors wir die Daten gruppieren sollen; am einfachsten ist es immer, wenn man sich an seiner erstellten Abbildung orientiert. In dieser war der Unterschied zwischen Läufern und der Kontrollgruppe auf der <span class="math inline">\(x\)</span>-Achse, also gruppieren wir anhand dieses Faktors und untersuchen so den Einfluss von Geschlecht auf die Herzrate pro Faktorstufe von “Gruppe”.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>runners <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="st">  </span><span class="kw">group_by</span>(group) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">  </span><span class="kw">anova_test</span>(heart_rate <span class="op">~</span><span class="st"> </span>gender, <span class="dt">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 8
##   group   Effect   DFn   DFd     F        p `p&lt;.05`   ges
##   &lt;fct&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1 Control gender     1   398 116.  5.82e-24 *       0.226
## 2 Runners gender     1   398  70.1 9.57e-16 *       0.15</code></pre>
<p>Durch die <em>Simple Effects Analysis</em> haben wir nun herausgefunden, dass sich Männer und Frauen in beiden Gruppen signifikant voneinander unterscheiden. Die Effektstärken geben Aufschluss darüber, dass der Unterschied zwischen den Geschlechtern in der Kontrollgruppe größer ist (<span class="math inline">\(r = .48\)</span>)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> als in der Gruppe der Läufer (<span class="math inline">\(.39\)</span>).</p>
</div>
<div id="berichten-1" class="section level3">
<h3>Berichten</h3>
<p>We found the subjects’ heart rate after a six minute workout to be dependent on both, gender and group membership. Generally, the control group had higher heart rates than the runners’ group and women had higher heart rates than men. The interaction effect was significant, <span class="math inline">\(F(1, 796) = 7.41, p = .007\)</span>, indicating a greater difference between genders in the control group (<span class="math inline">\(r = .48\)</span>) than in the runners’ group (<span class="math inline">\(r = .39\)</span>).</p>
</div>
</div>
<div id="beispiel_robust" class="section level2">
<h2>Robust</h2>
<p>Da die Voraussetzung der Varianzhomogenität aufgrund des signifikanten Levene-Tests nicht gegeben ist, sollten wir robuste Methoden zur Auswertung der Daten nutzen.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">t2way</span>(heart_rate <span class="op">~</span><span class="st"> </span>gender <span class="op">*</span><span class="st"> </span>group, <span class="dt">data =</span> runners)</span></code></pre></div>
<pre><code>## Call:
## t2way(formula = heart_rate ~ gender * group, data = runners)
## 
##                 value p.value
## gender       173.6615   0.001
## group        646.4237   0.001
## gender:group   5.1151   0.025</code></pre>
<p>Auch auf Basis getrimmter Mittelwerte ist der Interaktionseffekt signifikant, <span class="math inline">\(\hat{\Psi} = 5.12, p = .025\)</span>. Post-hoc-Tests entfallen hier, weil wir durch unser 2 <span class="math inline">\(\times\)</span> 2 Versuchs-Design bereits sagen können, dass es einen Interaktionseffekt gibt (der robuste Post-hoc-Test würde nur bestätigen, was wir schon wissen.)</p>
</div>
</div>
<div id="literatur" class="section level1 unnumbered">
<h1>Literatur</h1>
<div id="refs" class="references">
<div id="ref-Bibby.2010">
<p>Bibby, P. (2010). Simple Main Effects. In N. J. Salkind (Ed.), <em>Encyclopedia of Research Design</em>. SAGE. <a href="https://doi.org/10.4135/9781412961288.n421">https://doi.org/10.4135/9781412961288.n421</a></p>
</div>
<div id="ref-Mair.2020">
<p>Mair, P., &amp; Wilcox, R. R. (2020). Robust statistical methods in R using the WRS2 package. <em>Behavior Research Methods</em>, <em>52</em>(2), 464–488. <a href="https://doi.org/10.3758/s13428-019-01246-w">https://doi.org/10.3758/s13428-019-01246-w</a></p>
</div>
<div id="ref-Moore.2017">
<p>Moore, D. S., McCabe, G. P., &amp; Craig, B. A. (2017). <em>Introduction to the practice of statistics</em> (9th ed.). W. H. Freeman.</p>
</div>
<div id="ref-Wilcox.2017">
<p>Wilcox, R. R. (2017). <em>Introduction to Robust Estimation and Hypothesis Testing</em> (4th ed.). Elsevier Academic Press.</p>
</div>
<div id="ref-Wood.1977">
<p>Wood, P. D., Haskell, W. L., Stern, M. P., Lewis, S., &amp; Perry, C. (1977). Plasma lipoprotein distributions in male and female runners. <em>Annals of the New York Academy of Sciences</em>, <em>301</em>, 748–763. <a href="https://doi.org/10.1111/j.1749-6632.1977.tb38244.x">https://doi.org/10.1111/j.1749-6632.1977.tb38244.x</a></p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Hätten wir mehrere Faktorlevel und müssten nur eine Gruppe “nach ganz vorne bringen”, können wir das mit <code>fct_relevel(&lt;VARIABLE&gt;, "&lt;CONTROLGROUP&gt;")</code> erreichen.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Berechnet mit der Formel <a href="#effect_size">oben</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
